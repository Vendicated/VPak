let l="length",s="subarray",t="encode",f=255,x=new TextDecoder,y=new TextEncoder,z=y[t]`VPak 1.1`;export let serialize=a=>{let n=Object.keys(a),i=8,u,e=n.map(o=>(i+=(u=y[t](o))[l]+a[o][l]+5,u)),o=new Uint8Array(i),v=8,g=0;o.set(z,0);n.map(i=>{o[v++]=(u=e[g++])[l];o.set(u,v);o[v+=u[l]+1]=(n=a[i][l])>>24&f;o[v++]=n>>16&f;o[v++]=n>>8&f;o[v++]=n&f;o.set(a[i],v);v+=n});return o},deserialize=a=>{if(z.some((i,u)=>i!=a[u]))throw Error`Invalid header`;let h,e,o,i={},u=8;for(;u<a[l];i[o]=a[s](u,u+=e))h=a[u++],o=x.decode(a[s](u,u+=h)),e=a[u++]<<24|a[u++]<<16|a[u++]<<8|a[u++];return i}
